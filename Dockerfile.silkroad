FROM kittymac/silkroad:latest

WORKDIR /root/SilkRoad

COPY ./Makefile ./Makefile
COPY ./Package.swift ./Package.swift
COPY ./Sources ./Sources
COPY ./Tests ./Tests

RUN /usr/bin/swift-build-all

RUN /usr/bin/patch-dependency Hitch Spanker
RUN /usr/bin/patch-dependency Spanker Sextant
RUN /usr/bin/patch-dependency Chronometer Sextant

RUN /usr/bin/patch-dependency Spanker SilkRoadFramework
RUN /usr/bin/patch-dependency Sextant SilkRoadFramework

